from moleculekit.molecule import Molecule
from moleculekit.tools.voxeldescriptors import getVoxelDescriptors, viewVoxelFeatures
from moleculekit.tools.atomtyper import prepareProteinForAtomtyping
from moleculekit.smallmol.smallmol import SmallMol
from moleculekit.home import home
import os


os.chdir('/home/users/jvs15/project-protein-fold')

prot = Molecule('pdb_data_files/AF-Q8VGS3-F1-model_v2.pdb')

ligand = SmallMol('moleculekit/mol_files/Prenylacetate.mol', force_reading=True)

prot = prepareProteinForAtomtyping(prot)

prot_vox, prot_centers, prot_N = getVoxelDescriptors(prot, voxelsize=0.5, buffer=1)
lig_vox, lig_centers, lig_N = getVoxelDescriptors(ligand, voxelsize=0.5, buffer=1)

"""
prot.view(guessBonds=False)
viewVoxelFeatures(prot_vox, prot_centers, prot_N)

slig.view(guessBonds=False)
viewVoxelFeatures(lig_vox, lig_centers, lig_N)
"""
